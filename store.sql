DROP DATABASE IF EXISTS tienda;

CREATE DATABASE tienda;

USE tienda;

CREATE TABLE usuario (
  idUsuario INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  provider VARCHAR(80) COLLATE utf8_spanish_ci,
  idSocialNetwork VARCHAR(254) COLLATE utf8_spanish_ci,
  email VARCHAR(80) COLLATE utf8_spanish_ci,
  name VARCHAR(80) COLLATE utf8_spanish_ci,
  photoUrl VARCHAR(80) COLLATE utf8_spanish_ci,
  firstName VARCHAR(80) COLLATE utf8_spanish_ci,
  lastName VARCHAR(80) COLLATE utf8_spanish_ci,
  authToken VARCHAR(80) COLLATE utf8_spanish_ci,
  idToken VARCHAR(80) COLLATE utf8_spanish_ci,
  authorizationCode VARCHAR(80) COLLATE utf8_spanish_ci,
  createAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP() ON UPDATE CURRENT_TIMESTAMP(),
  updateAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP() ON UPDATE CURRENT_TIMESTAMP()
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE direccion (
  idDireccion INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idUsuario INT,
  calle VARCHAR(80) COLLATE utf8_spanish_ci,
  calleNumero VARCHAR(80) COLLATE utf8_spanish_ci,
  codigoPostal INT,
  informacionAdicional VARCHAR(80) COLLATE utf8_spanish_ci,
  latitude DECIMAL(10, 2),
  longitude DECIMAL(10, 2),
  FOREIGN KEY (idUsuario) REFERENCES usuario(idUsuario)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE telefono (
  idTelefono INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idUsuario INT,
  telefono VARCHAR(80) COLLATE utf8_spanish_ci,
  FOREIGN KEY (idUsuario) REFERENCES usuario(idUsuario)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE producto (
  idProducto INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idUsuario INT,
  stock int,
  nombre VARCHAR(80) COLLATE utf8_spanish_ci,
  descripcion VARCHAR(254) COLLATE utf8_spanish_ci,
  precio DECIMAL(10, 2),
  FOREIGN KEY (idUsuario) REFERENCES usuario(idUsuario)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE productoImg (
  idProductoImg INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idProducto INT,
  img VARCHAR(200) COLLATE utf8_spanish_ci,
  thumbnail VARCHAR(200) COLLATE utf8_spanish_ci,
  FOREIGN KEY (idProducto) REFERENCES producto(idProducto)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE ProductoPrecio (
  idProductoPrecio INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idProducto INT,
  precio DECIMAL(10, 2),
  FOREIGN KEY (idProducto) REFERENCES producto(idProducto)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE carrito (
  idCarrito INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idUsuario INT,
  idProducto INT,
  cantidad INT,
  FOREIGN KEY (idUsuario) REFERENCES usuario(idUsuario),
  FOREIGN KEY (idProducto) REFERENCES producto(idProducto)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

CREATE TABLE venta (
  idVenta INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  idUsuario INT,
  idProducto INT,  
  cantidad INT,
  precio DECIMAL(10, 2),
  estadoVenta INT,
  FOREIGN KEY (idUsuario) REFERENCES usuario(idUsuario),
  FOREIGN KEY (idProducto) REFERENCES producto(idProducto),
  FOREIGN KEY (idProductoPrecio) REFERENCES ProductoPrecio(idProductoPrecio)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COLLATE = utf8_spanish_ci;

-- 30000,250093,251533,251632,251712,259058,259115,259820,259823,260357,263441,263668,265695,272938,272976,273805,275553,279480,280060,280474,280589,282017,284816,294022,295457,987654,987655,987656,250094,250095,250096,284264
-- 3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,70,71,72,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,107,108,110,111,113,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,138,139,140,141,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,201,202,203,204,205,206,207,208,210,211,212,40593,40594,40609,40614,40643,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,10120,10121,10122,10123,10124,10125,10126,10127,10128,10129,10130,10131,20120,20121,20122,20123,20124,20125,20126,20127,30120,30121,30122,30123,30124,30125,30126,30127,30128,30129,30130,30131,30132,30133,30134,30135,30136,30137,30138,30139,30140,30141,30142,30143,30144,30145,30146,30147,30148,30149,30150,30151,30152,30153,30154,30155,30156,30157,30158,30159,30160,30161,30162,30163,30164,30165,30166,30167,30168,30169,30170,30171,30172,30173,30174,30175,30176,30177,30178,30179,30180,30181,30182,30183,30184,30185,30186,30187,30188,30189,30190,30191,30192,30193,30194,30195,30196,30197,30198,30199,30200,30201,30202,30203,30204,30205,30206,30207,30208,30209,30210,30211,30212,30213,30214,30215,30216,30217,30218,30219,30220,30221,30222,30223,30224,30225,30226,30227,30228,30229,30230,30231,30232,30233,30234,30235,30236,30237,30238,30239,30240,30241,30242,30243,30244,30245,30246,30247,30248,30249,30250,30251,30252,30253,30254,30255,30256,30257,30258,30259,30260,30261,30262,30263,30264,30265,30266,30267,30268,30269,30270,30271,30272,30273,30274,30275,30276,30277,30278,30279,30280,30281,30282,30283,30284,30285,30286,30287,30288,30289,30290,30291,30292,30293,30294,30295,30296,30297,30298,30299,30300,30301,30302,30303,30304,30305,30306,30307,30308,30309,30310,30311,30312,30313,30314,30315,30316,30317,30318,30319,30320,30321,30322,30323,30324,30325,30326,30327,30328,30329,30330,30331,30332,30333,30334,30335,30336,30337,30338,30339,30340,30341,30342,30343,30344,30345,30346,30347,30348,30349,30350,30351,30352,30353,30354,30355,30356,30357,30358,30359,30360,30361,30362,30363,30364,30365,30366,30367,30368,30369,30370,30371,30372,30373,30374,30375,30376,30377,30378,30379,30380,30381,30382,30383,30384,30385,30386,30387,30388,30389,30390,30391,30392,30393,30394,30395,30396,30397,30398,30399,30400,30401,30402,30403,30404,30405,30406,30407,30408,30409,30410,30411,30412,30413,30414,30415,30416,30417,30418,30419,30420,30421,30422,30423,30424,30425,30426,30427,30428,30429,30430,30431,30432,30433,30434,30435,30436,30437,30438,30439,30440,30441,30442,30443,30444,30445,30446,30447,30448,30449,30450,30451,30452,30453,30454,30455,30456,30457,30458,30459,30460,30461,30462,30463,30464,30465,30466,30467,30468,30469,30470,30471,30472,30473,30474,30475,30476,30477,30478,30479,30480,30481,30482,30483,30484,30485,30486,30487,30488,30489,30490,30491,30492,30493,30494,30495,30496,30497,30498,30499,30500,30501,30502,30503,30504,30505,30506,30507,30508,30509,30510,30511,30512,30513,30514,30515,30516,30517,30518,30519,30520,30521,30522,30523,30524,30525,30526,30527,30528,30529,30530,30531,30532,30533,30534,30535,30536,30537,30538,30539,30540,30541,30542,30543,30544,30545,30546,30547,30548,30549,30550,30551,30552,30553,30554,30555,30556,30557,30558,30559,30560,30561,30562,30563,30564,30565,30566,30567,30568,30569,30570,30571,30572,30573,30574,30575,30576,30577,30578,30579,30580,30581,30582,30583,30584,30585,30586,30587,30588,30589,30590,30591,40590,40591,40592,40604,40605,40606,40607,40608,40610,40611,40612,40613,40627,40628,40629,40630,40635,40636,63,64,65,66,67,68,69,40599,40595,40596,40597,40598,40600,40601,40602,40603,40615,40616,40617,40618,40619,40620,40621,40622,40623,40624,40625,40626,40631,40632,40633,40634,40637,40638,40639,40640,40641,40642
-- [id],
-- [version],
-- [rfc_emisor],
-- [rfc_receptor],
-- [series],
-- [folio],
-- [fecha_registro],
-- sum([total]),
-- [impuestos],
-- [cfdi_xml],
-- [cadena_original],
-- [UUID],
-- [fecha_timbrado],
-- [fecha_blob],
-- [path_blob],
-- [ws_status],
-- [idProceso],
-- [async]